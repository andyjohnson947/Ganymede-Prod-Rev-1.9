# ğŸ“Š GANYMEDE TRADING BOT - COMPLETE LOGIC STORYBOARD

*Keep It Simple, Stupid (KISS) Edition*

---

## ğŸš€ PHASE 1: BOT STARTUP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. CONNECT TO MT5 BROKER                                   â”‚
â”‚     â”œâ”€ Login credentials                                    â”‚
â”‚     â”œâ”€ Verify connection                                    â”‚
â”‚     â””â”€ Get account balance                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. LOAD SAVED STATE (Crash Recovery)                       â”‚
â”‚     â”œâ”€ Read recovery_state.json                             â”‚
â”‚     â”œâ”€ Load tracked positions (DCA/Hedge history)           â”‚
â”‚     â””â”€ If no state: start fresh                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. RECONCILE WITH MT5 REALITY                              â”‚
â”‚     â”œâ”€ Get all open positions from broker                   â”‚
â”‚     â”œâ”€ Match with saved state                               â”‚
â”‚     â”œâ”€ Add new positions we don't know about                â”‚
â”‚     â”œâ”€ Remove closed positions from tracking                â”‚
â”‚     â””â”€ Reconstruct recovery stacks (DCA/Hedge levels)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. EVALUATE MARKET STATE (NEW!)                            â”‚
â”‚     For each symbol (EURUSD, GBPUSD, USDJPY):               â”‚
â”‚     â”œâ”€ Fetch H1 data (500 bars)                             â”‚
â”‚     â”œâ”€ Calculate ADX (trend strength)                       â”‚
â”‚     â”œâ”€ Check if ADX > 40 (EXTREME trend)                    â”‚
â”‚     â”‚  â””â”€ If YES: Block trading for that symbol             â”‚
â”‚     â”‚  â””â”€ If NO: Allow trading                              â”‚
â”‚     â””â”€ Log: âœ… EURUSD Trading ALLOWED or âš ï¸ BLOCKED         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    ğŸŸ¢ ENTER MAIN LOOP
```

---

## ğŸ”„ PHASE 2: MAIN TRADING LOOP (Every ~3 seconds)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FOR EACH SYMBOL (EURUSD, GBPUSD, USDJPY):                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                       â”‚
        â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  A. REFRESH      â”‚                  â”‚  B. MANAGE       â”‚
â”‚     MARKET DATA  â”‚                  â”‚     EXISTING     â”‚
â”‚                  â”‚                  â”‚     POSITIONS    â”‚
â”‚  Every 60 min    â”‚                  â”‚  Every loop      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                       â”‚
        â”‚                                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  C. LOOK FOR     â”‚
                  â”‚     NEW SIGNALS  â”‚
                  â”‚                  â”‚
                  â”‚  If allowed      â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¡ PHASE 2A: REFRESH MARKET DATA (Every 60 Minutes)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check: Has 60 minutes passed since last refresh?           â”‚
â”‚  â”œâ”€ NO:  Skip (use cached data)                             â”‚
â”‚  â””â”€ YES: Continue to refresh...                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FETCH DATA FROM BROKER:                                    â”‚
â”‚  â”œâ”€ H1 (Hourly):  500 bars â†’ Calculate VWAP bands           â”‚
â”‚  â”œâ”€ M15 (15min):  100 bars â†’ Fast trend detection           â”‚
â”‚  â”œâ”€ D1 (Daily):   100 bars â†’ Swing highs/lows               â”‚
â”‚  â””â”€ W1 (Weekly):   50 bars â†’ Major levels                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CALCULATE INDICATORS:                                      â”‚
â”‚  â”œâ”€ VWAP (Volume Weighted Average Price)                    â”‚
â”‚  â”‚  â”œâ”€ +1Ïƒ band (1 std deviation above)                     â”‚
â”‚  â”‚  â”œâ”€ +2Ïƒ band (2 std deviations above)                    â”‚
â”‚  â”‚  â”œâ”€ +3Ïƒ band (3 std deviations above)                    â”‚
â”‚  â”‚  â”œâ”€ -1Ïƒ band (1 std deviation below)                     â”‚
â”‚  â”‚  â”œâ”€ -2Ïƒ band (2 std deviations below)                    â”‚
â”‚  â”‚  â””â”€ -3Ïƒ band (3 std deviations below)                    â”‚
â”‚  â”œâ”€ Volume Profile (POC, VAH, VAL, HVN, LVN)                â”‚
â”‚  â”œâ”€ ATR (Average True Range - 14 period)                    â”‚
â”‚  â””â”€ HTF Swing Points (Daily/Weekly highs & lows)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RE-EVALUATE MARKET STATE (NEW!):                           â”‚
â”‚  â”œâ”€ Calculate ADX (trend strength indicator)                â”‚
â”‚  â”œâ”€ If ADX > 40: Set market_trending_block = True           â”‚
â”‚  â”œâ”€ If ADX < 40: Set market_trending_block = False          â”‚
â”‚  â””â”€ Log if status changed:                                  â”‚
â”‚     â”œâ”€ âœ… "Market IMPROVED - Trading RESUMED"               â”‚
â”‚     â””â”€ âš ï¸ "Market DEGRADED - Trading BLOCKED"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Store in cache & continue
```

---

## ğŸ¯ PHASE 2B: MANAGE EXISTING POSITIONS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GET ALL OPEN POSITIONS FOR THIS SYMBOL                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Any positions?  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    NO â†™        â†˜ YES
                  Skip        Continue
                               â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  FOR EACH POSITION:                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: CHECK EMERGENCY STOPS                              â”‚
â”‚  â”œâ”€ Stack Stop Loss (DCA/Hedge combined loss too high)      â”‚
â”‚  â”‚  â”œâ”€ DCA only:  Close if loss > -$20                      â”‚
â”‚  â”‚  â””â”€ DCA+Hedge: Close if loss > -$30                      â”‚
â”‚  â”œâ”€ Grid Max Stops (Grid levels hit max loss)               â”‚
â”‚  â””â”€ Individual Stop Loss (if set)                           â”‚
â”‚                                                              â”‚
â”‚  If triggered: CLOSE ALL related positions â†’ DONE           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: CHECK IF POSITION NEEDS RECOVERY                   â”‚
â”‚  (Only for ORIGINAL positions, not DCA/Grid/Hedge)          â”‚
â”‚                                                              â”‚
â”‚  Position underwater? (negative P&L)                        â”‚
â”‚  â”œâ”€ NO:  Go to STEP 3 (Check Exits)                         â”‚
â”‚  â””â”€ YES: Continue to recovery checks...                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RECOVERY CHECK A: DCA (Dollar Cost Averaging)              â”‚
â”‚  â”œâ”€ Enabled? (DCA_ENABLED = True)                           â”‚
â”‚  â”œâ”€ Already added DCA? Check level count                    â”‚
â”‚  â”œâ”€ Position pips underwater:                               â”‚
â”‚  â”‚  â””â”€ EURUSD: 30 pips down                                 â”‚
â”‚  â”‚  â””â”€ GBPUSD: 40 pips down                                 â”‚
â”‚  â”‚  â””â”€ USDJPY: 35 pips down                                 â”‚
â”‚  â””â”€ If triggered:                                           â”‚
â”‚     â”œâ”€ Open SAME direction trade                            â”‚
â”‚     â”œâ”€ Lot size = Original Ã— 1.2 (20% bigger)               â”‚
â”‚     â”œâ”€ Comment: "DCA-Lv1 for [original_ticket]"             â”‚
â”‚     â””â”€ Purpose: Average down entry price                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RECOVERY CHECK B: HEDGE (Opposite Direction)               â”‚
â”‚  â”œâ”€ Enabled? (HEDGE_ENABLED = True)                         â”‚
â”‚  â”œâ”€ Already hedged? (max 1 hedge per position)              â”‚
â”‚  â”œâ”€ Position pips underwater:                               â”‚
â”‚  â”‚  â””â”€ EURUSD: 45 pips down                                 â”‚
â”‚  â”‚  â””â”€ GBPUSD: 55 pips down                                 â”‚
â”‚  â”‚  â””â”€ USDJPY: 50 pips down                                 â”‚
â”‚  â””â”€ If triggered:                                           â”‚
â”‚     â”œâ”€ Open OPPOSITE direction trade                        â”‚
â”‚     â”œâ”€ Lot size = Original Ã— 1.5 (50% bigger)               â”‚
â”‚     â”œâ”€ Comment: "Hedge for [original_ticket]"               â”‚
â”‚     â””â”€ Purpose: Lock in loss, profit from reversal          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RECOVERY CHECK C: CLOSE HEDGE EARLY?                       â”‚
â”‚  If hedge exists and is profitable:                         â”‚
â”‚  â”œâ”€ Hedge profit > +10 pips? (EURUSD)                       â”‚
â”‚  â”œâ”€ Market stopped trending? (ADX < 25)                     â”‚
â”‚  â””â”€ If YES:                                                 â”‚
â”‚     â”œâ”€ Close hedge â†’ Lock in hedge profit                   â”‚
â”‚     â””â”€ Keep original position running                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: CHECK PROFIT TARGETS & EXITS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIT 1: Partial Close 1 (PC1)                              â”‚
â”‚  â”œâ”€ Not done yet?                                           â”‚
â”‚  â”œâ”€ Position profit in pips:                                â”‚
â”‚  â”‚  â””â”€ EURUSD: +10 pips                                     â”‚
â”‚  â”‚  â””â”€ GBPUSD: +12 pips                                     â”‚
â”‚  â”‚  â””â”€ USDJPY: +11 pips                                     â”‚
â”‚  â””â”€ If triggered:                                           â”‚
â”‚     â”œâ”€ Close 25% of position                                â”‚
â”‚     â”œâ”€ Lock in some profit                                  â”‚
â”‚     â””â”€ Let 75% run for more profit                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIT 2: Partial Close 2 (PC2)                              â”‚
â”‚  â”œâ”€ PC1 already done?                                       â”‚
â”‚  â”œâ”€ Position profit in pips:                                â”‚
â”‚  â”‚  â””â”€ EURUSD: +20 pips                                     â”‚
â”‚  â”‚  â””â”€ GBPUSD: +25 pips                                     â”‚
â”‚  â”‚  â””â”€ USDJPY: +22 pips                                     â”‚
â”‚  â””â”€ If triggered:                                           â”‚
â”‚     â”œâ”€ Close another 25% of position                        â”‚
â”‚     â”œâ”€ Now only 50% of original remains                     â”‚
â”‚     â””â”€ Activate TRAILING STOP for final 50%                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIT 3: Trailing Stop                                      â”‚
â”‚  â”œâ”€ PC2 done? (trailing activated)                          â”‚
â”‚  â”œâ”€ Track highest profit reached                            â”‚
â”‚  â”œâ”€ Distance: 2.0 Ã— ATR (min 25 pips, max 50 pips)          â”‚
â”‚  â””â”€ If price drops from peak by trailing distance:          â”‚
â”‚     â””â”€ CLOSE entire position â†’ Lock in profits              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIT 4: Time Limit                                         â”‚
â”‚  â”œâ”€ PC2 done?                                               â”‚
â”‚  â”œâ”€ Time since PC2 > 60 minutes?                            â”‚
â”‚  â””â”€ If YES: CLOSE position â†’ Avoid giving back profits      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXIT 5: VWAP Reversion (Mean Reversion Exit)               â”‚
â”‚  â”œâ”€ Entry was VWAP bounce? (mean reversion strategy)        â”‚
â”‚  â”œâ”€ Price returned to VWAP?                                 â”‚
â”‚  â”œâ”€ Profit < 10 pips? (small profit)                        â”‚
â”‚  â””â”€ If YES: CLOSE position â†’ Take small profit              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Position managed âœ“
```

---

## ğŸ” PHASE 2C: LOOK FOR NEW SIGNALS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRE-CHECK 1: Can we open new positions?                    â”‚
â”‚  â”œâ”€ Total open positions < 3? (MAX_OPEN_POSITIONS)          â”‚
â”‚  â”œâ”€ This symbol has < 1 position? (MAX_PER_SYMBOL)          â”‚
â”‚  â””â”€ If NO to either: STOP (can't open new trades)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRE-CHECK 2: Trading hours OK?                             â”‚
â”‚  â”œâ”€ Not weekend?                                            â”‚
â”‚  â”œâ”€ Not holiday? (check calendar)                           â”‚
â”‚  â”œâ”€ Not Friday after 12 PM GMT?                             â”‚
â”‚  â”œâ”€ Within trading window? (00:00-23:59 GMT)                â”‚
â”‚  â””â”€ If NO to any: STOP (outside trading hours)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRE-CHECK 3: Symbol blocked?                               â”‚
â”‚  â”œâ”€ CASCADE BLOCK active?                                   â”‚
â”‚  â”‚  â””â”€ Multiple stop-outs triggered emergency block         â”‚
â”‚  â”‚  â””â”€ Block expires after 60 minutes                       â”‚
â”‚  â”œâ”€ MARKET TRENDING BLOCK active?                           â”‚
â”‚  â”‚  â””â”€ ADX > 40 (EXTREME trend - too dangerous)             â”‚
â”‚  â”‚  â””â”€ Re-checked every 60 min or on startup                â”‚
â”‚  â””â”€ If ANY block active: STOP (safety mechanism)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SIGNAL DETECTION: Mean Reversion Strategy                  â”‚
â”‚  (Currently ENABLED - BREAKOUT_ENABLED = False)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Check Price vs VWAP Bands                          â”‚
â”‚  â”œâ”€ BULLISH SETUP (price near bottom bands):                â”‚
â”‚  â”‚  â”œâ”€ At -1Ïƒ? â†’ Score: +1                                  â”‚
â”‚  â”‚  â”œâ”€ At -2Ïƒ? â†’ Score: +2                                  â”‚
â”‚  â”‚  â””â”€ At -3Ïƒ? â†’ Score: +3 (extreme oversold)               â”‚
â”‚  â”‚                                                           â”‚
â”‚  â””â”€ BEARISH SETUP (price near top bands):                   â”‚
â”‚     â”œâ”€ At +1Ïƒ? â†’ Score: +1                                  â”‚
â”‚     â”œâ”€ At +2Ïƒ? â†’ Score: +2                                  â”‚
â”‚     â””â”€ At +3Ïƒ? â†’ Score: +3 (extreme overbought)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Check Volume Profile Confluence                    â”‚
â”‚  â”œâ”€ Price near POC (Point of Control)?    â†’ Score: +1       â”‚
â”‚  â”œâ”€ Price near VAL (Value Area Low)?      â†’ Score: +1       â”‚
â”‚  â”œâ”€ Price near VAH (Value Area High)?     â†’ Score: +1       â”‚
â”‚  â”œâ”€ Price at HVN (High Volume Node)?      â†’ Score: +1       â”‚
â”‚  â””â”€ Price at LVN (Low Volume Node)?       â†’ Score: +1       â”‚
â”‚                                                              â”‚
â”‚  (More confluence = higher probability trade)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Check HTF (Daily/Weekly) Levels                    â”‚
â”‚  â”œâ”€ Price near Daily Swing Low?    â†’ Score: +1 (bullish)    â”‚
â”‚  â”œâ”€ Price near Daily Swing High?   â†’ Score: +1 (bearish)    â”‚
â”‚  â”œâ”€ Price near Weekly Swing Low?   â†’ Score: +1 (bullish)    â”‚
â”‚  â””â”€ Price near Weekly Swing High?  â†’ Score: +1 (bearish)    â”‚
â”‚                                                              â”‚
â”‚  (Institutional levels = strong support/resistance)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: Calculate Total Confluence Score                   â”‚
â”‚  â”œâ”€ Add up all scores from VWAP + Volume + HTF              â”‚
â”‚  â”œâ”€ Minimum required: 4 points                              â”‚
â”‚  â””â”€ If score < 4: NO SIGNAL (not enough confluence)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: ADX Trend Filter (Avoid trending markets)          â”‚
â”‚  â”œâ”€ Calculate ADX (trend strength)                          â”‚
â”‚  â”œâ”€ If ADX > 40: REJECT (too much trend, mean reversion    â”‚
â”‚  â”‚                        doesn't work in strong trends)    â”‚
â”‚  â””â”€ If ADX < 40: ACCEPT (ranging/weak trend OK)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SIGNAL DETECTED! âœ“                                         â”‚
â”‚  â”œâ”€ Direction: BUY or SELL                                  â”‚
â”‚  â”œâ”€ Confluence Score: 4-10                                  â”‚
â”‚  â”œâ”€ Entry Price: Current market price                       â”‚
â”‚  â””â”€ Strategy Type: VWAP (mean reversion)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    OPEN NEW TRADE â†“
```

---

## ğŸ’° PHASE 3: OPEN NEW TRADE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Calculate Position Size                            â”‚
â”‚  â”œâ”€ Base lot size: 0.04 (fixed)                             â”‚
â”‚  â”œâ”€ Account balance: Get current balance                    â”‚
â”‚  â”œâ”€ Risk calculator validates lot size                      â”‚
â”‚  â””â”€ Final lot size: 0.04 lots                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Prepare Order                                      â”‚
â”‚  â”œâ”€ Symbol: EURUSD / GBPUSD / USDJPY                        â”‚
â”‚  â”œâ”€ Direction: BUY or SELL                                  â”‚
â”‚  â”œâ”€ Entry: Market order (current price)                     â”‚
â”‚  â”œâ”€ Lot Size: 0.04                                          â”‚
â”‚  â”œâ”€ Stop Loss: None (managed by recovery system)            â”‚
â”‚  â”œâ”€ Take Profit: None (managed by exit system)              â”‚
â”‚  â””â”€ Comment: "VWAP-S7" (strategy + confluence score)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Send Order to MT5                                  â”‚
â”‚  â”œâ”€ MT5 validates order                                     â”‚
â”‚  â”œâ”€ Checks margin requirements                              â”‚
â”‚  â”œâ”€ Executes at market price                                â”‚
â”‚  â””â”€ Returns ticket number (e.g., 123456789)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: Track Position                                     â”‚
â”‚  â”œâ”€ Add to tracked_positions dictionary                     â”‚
â”‚  â”œâ”€ Store entry details:                                    â”‚
â”‚  â”‚  â”œâ”€ Ticket number                                        â”‚
â”‚  â”‚  â”œâ”€ Entry time                                           â”‚
â”‚  â”‚  â”œâ”€ Entry price                                          â”‚
â”‚  â”‚  â”œâ”€ Lot size                                             â”‚
â”‚  â”‚  â”œâ”€ Direction (BUY/SELL)                                 â”‚
â”‚  â”‚  â”œâ”€ Confluence score                                     â”‚
â”‚  â”‚  â””â”€ Strategy type (VWAP)                                 â”‚
â”‚  â”œâ”€ Initialize recovery tracking:                           â”‚
â”‚  â”‚  â”œâ”€ DCA levels: []                                       â”‚
â”‚  â”‚  â”œâ”€ Hedges: []                                           â”‚
â”‚  â”‚  â””â”€ Grid levels: []                                      â”‚
â”‚  â””â”€ Save state to recovery_state.json                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: Log to ML System                                   â”‚
â”‚  â”œâ”€ Record trade entry for ML model                         â”‚
â”‚  â”œâ”€ Features captured (60+ features):                       â”‚
â”‚  â”‚  â”œâ”€ Market conditions at entry                           â”‚
â”‚  â”‚  â”œâ”€ Indicator values                                     â”‚
â”‚  â”‚  â”œâ”€ Time of day                                          â”‚
â”‚  â”‚  â”œâ”€ Confluence score                                     â”‚
â”‚  â”‚  â””â”€ Recent market volatility                             â”‚
â”‚  â””â”€ ML will track outcome for future predictions            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    TRADE OPENED âœ“
                            â†“
        Position now managed in PHASE 2B (next loop)
```

---

## ğŸš¨ PHASE 4: CASCADE PROTECTION (Emergency System)

*This runs continuously, monitoring total account risk*

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TRIGGER CONDITION:                                         â”‚
â”‚  Total unrealized loss across ALL positions â‰¤ -$100         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DETECTION:                                                 â”‚
â”‚  â”œâ”€ Position 1 (EURUSD): -$35                               â”‚
â”‚  â”œâ”€ Position 2 (GBPUSD): -$42                               â”‚
â”‚  â”œâ”€ Position 3 (USDJPY): -$28                               â”‚
â”‚  â””â”€ Total: -$105 â†’ TRIGGER! ğŸš¨                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ CASCADE PROTECTION ACTIVATED ğŸš¨                         â”‚
â”‚                                                              â”‚
â”‚  ACTION 1: CLOSE ALL POSITIONS IMMEDIATELY                  â”‚
â”‚  â”œâ”€ Close all original positions                            â”‚
â”‚  â”œâ”€ Close all DCA positions                                 â”‚
â”‚  â”œâ”€ Close all hedges                                        â”‚
â”‚  â”œâ”€ Close all grid levels                                   â”‚
â”‚  â””â”€ Clear all tracked position data                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ACTION 2: ANALYZE MARKET STATE                             â”‚
â”‚  â”œâ”€ Calculate ADX for each symbol                           â”‚
â”‚  â”œâ”€ Check if market transitioned to trending:               â”‚
â”‚  â”‚  â””â”€ ADX > 25? â†’ Market started trending                  â”‚
â”‚  â””â”€ Determine affected symbols                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ACTION 3: ACTIVATE TRADING BLOCKS                          â”‚
â”‚  â”œâ”€ Global Block:                                           â”‚
â”‚  â”‚  â””â”€ Block ALL trading for 60 minutes                     â”‚
â”‚  â”œâ”€ Per-Symbol Cascade Block:                               â”‚
â”‚  â”‚  â””â”€ Block affected symbols for 60 minutes                â”‚
â”‚  â””â”€ Market Trending Block:                                  â”‚
â”‚     â””â”€ Block if ADX > 40 (until market calms down)          â”‚
â”‚        â””â”€ Re-evaluated every 60 min + on startup            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RECOVERY:                                                  â”‚
â”‚  â”œâ”€ Wait 60 minutes (time-based blocks expire)              â”‚
â”‚  â”œâ”€ Market trending block clears when:                      â”‚
â”‚  â”‚  â”œâ”€ Bot restarts, OR                                     â”‚
â”‚  â”‚  â”œâ”€ 60 min passes and ADX drops below 40                 â”‚
â”‚  â””â”€ Normal trading resumes                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ EXAMPLE: COMPLETE TRADE LIFECYCLE

```
TIME    EVENT                                    P&L      ACTIONS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

10:00   â”Œâ”€ SIGNAL DETECTED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ EURUSD at -2Ïƒ VWAP band (oversold)                    â”‚
        â”‚ Confluence: Daily swing low + HVN + POC = Score 7     â”‚
        â”‚ ADX: 28 (not trending too much - SAFE)                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

10:01   ğŸŸ¢ OPEN BUY 0.04 lots @ 1.0850           $0.00   Entry
        â””â”€ Comment: "VWAP-S7"

        [Position tracked, waiting for price movement...]

10:15   ğŸ“‰ Price drops to 1.0820                -$12.00  Floating loss
        â””â”€ Still within tolerance, no action

10:30   ğŸ“‰ Price drops to 1.0815                -$14.00  Floating loss
        â””â”€ Approaching DCA trigger (30 pips = -$12 per 0.01 lot)

10:35   ğŸ“‰ Price drops to 1.0810                -$16.00  Floating loss
        â””â”€ Approaching DCA trigger...

10:40   ğŸ“‰ Price hits 1.0820 (30 pips down)    -$12.00  DCA TRIGGERED!

        ğŸ”µ OPEN DUY 0.048 lots @ 1.0820         -$12.00  DCA Level 1
        â””â”€ Comment: "DCA-Lv1 for 123456789"
        â””â”€ New average entry: 1.0837
        â””â”€ Now have: 0.04 + 0.048 = 0.088 lots total

10:50   ğŸ“‰ Price continues to 1.0795            -$37.00  Still underwater
        â””â”€ Stack now: Original + DCA

11:00   ğŸ“‰ Price hits 1.0805 (45 pips from original) -$18.00 (DCA helping)

        ğŸ”´ HEDGE TRIGGERED!

        ğŸŸ  OPEN SELL 0.06 lots @ 1.0805         -$18.00  Hedge activated
        â””â”€ Comment: "Hedge for 123456789"
        â””â”€ Opposite direction = lock loss, profit from further drop
        â””â”€ Stack: Original BUY + DCA BUY + Hedge SELL

11:10   ğŸ“‰ Price drops to 1.0790                -$12.00  Hedge making money!
        â””â”€ Original BUY: -$24
        â””â”€ DCA BUY: -$14.40
        â””â”€ Hedge SELL: +$9.00
        â””â”€ Total stack: -$29.40

11:15   ğŸ“ˆ Price bounces to 1.0810               -$15.00  Bouncing back
        â””â”€ Original BUY: -$16
        â””â”€ DCA BUY: -$4.80
        â””â”€ Hedge SELL: -$3.00
        â””â”€ Total stack: -$23.80

11:30   ğŸ“ˆ Price continues to 1.0830             -$2.00   Almost breakeven
        â””â”€ Original BUY: -$8
        â””â”€ DCA BUY: +$4.80
        â””â”€ Hedge SELL: -$15.00 (losing now)
        â””â”€ Hedge underwater, but original recovering

11:35   ğŸ“ˆ Price hits 1.0835                    +$2.00   Stack profitable!
        â””â”€ Check hedge: -$18 (underwater 30 pips)
        â””â”€ ADX: 22 (market calmed down)

        âœ… CLOSE HEDGE @ 1.0835
        â””â”€ Hedge result: -$18.00 (took loss)
        â””â”€ But original positions now free to run

11:40   ğŸ“ˆ Price hits 1.0847                    +$12.00  PC1 TRIGGERED!

        âœ… PARTIAL CLOSE 1 (25% of 0.088 lots)
        â””â”€ Close: 0.022 lots @ 1.0847
        â””â”€ Locked profit: +$3.00
        â””â”€ Remaining: 0.066 lots
        â””â”€ Let rest run for more profit

12:00   ğŸ“ˆ Price hits 1.0857                    +$20.00  PC2 TRIGGERED!

        âœ… PARTIAL CLOSE 2 (25% of 0.088 lots)
        â””â”€ Close: 0.022 lots @ 1.0857
        â””â”€ Locked profit: +$5.00
        â””â”€ Remaining: 0.044 lots
        â””â”€ ğŸ¯ TRAILING STOP ACTIVATED (2.0Ã—ATR = 30 pips)

12:15   ğŸ“ˆ Price peaks at 1.0875                +$26.00  New high!
        â””â”€ Trailing stop now at: 1.0845 (30 pips below)
        â””â”€ Position tracking peak profit

12:30   ğŸ“‰ Price retraces to 1.0868             +$24.00  Still above trail
        â””â”€ Trailing stop: 1.0845
        â””â”€ Safe - let it run

12:45   ğŸ“‰ Price drops to 1.0855                +$18.00  Still above trail
        â””â”€ Trailing stop: 1.0845
        â””â”€ Getting closer...

13:00   ğŸ“‰ Price hits 1.0845                    +$12.00  TRAIL HIT!

        âœ… CLOSE REMAINING 0.044 lots @ 1.0845
        â””â”€ Trailing stop executed

        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        TRADE COMPLETE - FINAL P&L: +$8.00
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

        Breakdown:
        â”œâ”€ Original entry:   -$8 realized (partial closes)
        â”œâ”€ DCA contribution: +$4 realized
        â”œâ”€ Hedge cost:       -$18 realized
        â”œâ”€ PC1 profit:       +$3 realized
        â”œâ”€ PC2 profit:       +$5 realized
        â””â”€ Trail close:      +$22 realized

        Total time: 3 hours
        Max drawdown: -$37.00
        Final profit: +$8.00
```

---

## ğŸ›ï¸ KEY CONFIGURATION SETTINGS

```yaml
TRADING:
  Symbols: [EURUSD, GBPUSD, USDJPY]
  Base Lot Size: 0.04
  Max Open Positions: 3 (total)
  Max Per Symbol: 1 (original position)
  Trading Hours: 00:00 - 23:59 GMT (all day)

MEAN REVERSION STRATEGY:
  Enabled: True
  Min Confluence Score: 4
  VWAP Bands: Â±1Ïƒ, Â±2Ïƒ, Â±3Ïƒ
  ADX Filter: Reject if ADX > 40

BREAKOUT STRATEGY:
  Enabled: False (currently disabled)

RECOVERY SYSTEM:
  DCA:
    Enabled: True
    Trigger: -30 pips (EURUSD), -40 pips (GBPUSD)
    Multiplier: 1.2Ã— (20% larger)
    Max Levels: 1

  Hedge:
    Enabled: True
    Trigger: -45 pips (EURUSD), -55 pips (GBPUSD)
    Multiplier: 1.5Ã— (50% larger)
    Max Hedges: 1 per position

  Grid:
    Enabled: False (currently disabled)

EXIT SYSTEM:
  PC1: +10 pips (EURUSD) â†’ Close 25%
  PC2: +20 pips (EURUSD) â†’ Close 25% + Activate Trail
  Trailing Stop: 2.0Ã— ATR (min 25, max 50 pips)
  Time Limit: 60 minutes after PC2
  VWAP Reversion: Close if price returns to VWAP (<10 pip profit)

SAFETY SYSTEMS:
  Stack Stop Loss:
    DCA only: -$20 max loss
    DCA + Hedge: -$30 max loss

  Cascade Protection:
    Enabled: True
    Trigger: -$100 total unrealized loss
    Block Duration: 60 minutes

  Market Trending Block:
    Trigger: ADX > 40
    Re-check: Every 60 min + on startup
```

---

## ğŸ§  ML SYSTEM (Shadow Mode)

*Observes and learns, doesn't control trades*

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTINUOUS MONITORING (Every 60 seconds):                  â”‚
â”‚  â”œâ”€ Track all open positions                                â”‚
â”‚  â”œâ”€ Record P&L changes                                      â”‚
â”‚  â”œâ”€ Log recovery actions (DCA/Hedge/Grid)                   â”‚
â”‚  â”œâ”€ Log exit events (PC1/PC2/Trail/Stop)                    â”‚
â”‚  â””â”€ Store in ML database                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FEATURE EXTRACTION (60+ features per trade):               â”‚
â”‚  â”œâ”€ Entry conditions (VWAP distance, ADX, volatility)       â”‚
â”‚  â”œâ”€ Market context (time of day, day of week)               â”‚
â”‚  â”œâ”€ Position lifecycle (DCA used?, Hedge used?)             â”‚
â”‚  â”œâ”€ Exit type (PC1/PC2/Trail/Stop/VWAP reversion)           â”‚
â”‚  â””â”€ Final outcome (profit/loss, duration, max drawdown)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTO-RETRAINING (Every 8 hours):                           â”‚
â”‚  â”œâ”€ Collect recent trade data                               â”‚
â”‚  â”œâ”€ Retrain models (Random Forest / XGBoost)                â”‚
â”‚  â”œâ”€ Validate performance                                    â”‚
â”‚  â””â”€ Deploy new model if better                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DAILY REPORTS (8 AM GMT):                                  â”‚
â”‚  â”œâ”€ Email summary of previous day                           â”‚
â”‚  â”œâ”€ Win rate, profit/loss                                   â”‚
â”‚  â”œâ”€ Best/worst trades                                       â”‚
â”‚  â”œâ”€ Strategy performance breakdown                          â”‚
â”‚  â””â”€ ML model accuracy metrics                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Current Role: Observation & Learning
Future: Could provide trade quality predictions before entry
```

---

## ğŸ”„ COMPLETE FLOW DIAGRAM

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     BOT STARTS                          â”‚
        â”‚  â”œâ”€ Connect MT5                         â”‚
        â”‚  â”œâ”€ Load saved state                    â”‚
        â”‚  â”œâ”€ Reconcile positions                 â”‚
        â”‚  â””â”€ Evaluate market state (NEW!)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  MAIN LOOP (Every ~3 seconds)           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  FOR EACH SYMBOL:                       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  A. REFRESH DATA? (Every 60 min)        â”‚
        â”‚     â”œâ”€ Fetch H1/M15/D1/W1 data          â”‚
        â”‚     â”œâ”€ Calculate indicators             â”‚
        â”‚     â””â”€ Re-evaluate market state (NEW!)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  B. MANAGE EXISTING POSITIONS           â”‚
        â”‚     â”œâ”€ Check emergency stops            â”‚
        â”‚     â”œâ”€ Check recovery needs (DCA/Hedge) â”‚
        â”‚     â””â”€ Check exits (PC1/PC2/Trail)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  C. LOOK FOR NEW SIGNALS                â”‚
        â”‚     â”œâ”€ Pre-checks (limits, hours)       â”‚
        â”‚     â”œâ”€ Check blocks (cascade, trending) â”‚
        â”‚     â”œâ”€ Detect confluence (VWAP+Vol+HTF) â”‚
        â”‚     â”œâ”€ ADX filter                       â”‚
        â”‚     â””â”€ Open new trade if valid          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CONTINUOUS MONITORING:                 â”‚
        â”‚  â”œâ”€ Cascade protection (-$100 loss)     â”‚
        â”‚  â”œâ”€ ML system tracking                  â”‚
        â”‚  â””â”€ State saving (crash recovery)       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    Loop repeats â†’
```

---

## ğŸ“Š WHAT THIS BOT IS DESIGNED TO DO

**PRIMARY STRATEGY: Mean Reversion**
- Wait for price to deviate significantly from VWAP (oversold/overbought)
- Enter when multiple factors align (confluence)
- Ride the bounce back to fair value
- Exit with scaling profit targets

**RISK MANAGEMENT: Aggressive Recovery**
- DCA: Average down losing positions (make breakeven easier)
- Hedge: Lock losses and profit from reversals (insurance policy)
- Stack stops: Cut losses if recovery fails (emergency exit)

**EXIT STRATEGY: Scaled + Trailing**
- Take partial profits at fixed levels (secure gains)
- Let winners run with trailing stop (maximize profit)
- Time limits prevent holding too long (avoid reversals)

**SAFETY MECHANISMS:**
- Cascade protection: Emergency shutdown if many losses (-$100)
- Market trending block: Don't trade in extreme trends (ADX > 40)
- Position limits: Max 3 total, 1 per symbol (concentration risk)
- Trading hours: Avoid weekends, holidays, volatile times

**LEARNING SYSTEM (ML):**
- Shadow mode: Watch and learn, don't interfere
- Build database of what works / what doesn't
- Auto-retrain every 8 hours with new data
- Future: Could predict trade quality before entry

---

## âœ… CURRENT STATUS (After Fix)

```
âœ… Market trending block now resets on startup
âœ… Market state re-evaluated every 60 minutes
âœ… Clear logging of trading status per symbol
âœ… No more permanent lockouts from stale ADX readings
âœ… Bot will automatically resume trading when conditions improve
```

**The bot is now working as intended - ready to trade!** ğŸš€

---

*End of Storyboard - KISS Version*
